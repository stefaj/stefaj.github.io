<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Hidden Markov Models">
<meta name="keywords" content="probabilitymarkovmachine learning,  hidden, markov, model">
<title>Hidden Markov Models  | Algorithms</title>
<link rel="stylesheet" href="/algorithms/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/algorithms/css/modern-business.css">
<link rel="stylesheet" href="/algorithms/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/algorithms/css/customstyles.css">
<link rel="stylesheet" href="/algorithms/css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/algorithms/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/algorithms/js/toc.js"></script>
<script src="/algorithms/js/customscripts.js"></script>

<link rel="shortcut icon" href="/algorithms/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://stefanj.me/algorithms/algorithms/feed.xml">




 
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>

    <!-- Include me or rape -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="/algorithms/">&nbsp;<span class="projectTitle"> Algorithms</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<!-- Send feedback function -->
<script>
function SendLinkByMail(href) {
var subject= "Algorithms feedback";
var body = "I have some feedback about the Hidden Markov Models page: ";
body += window.location.href;
body += "";
var uri = "mailto:stefanj@encrunch.com?subject=";
uri += encodeURIComponent(subject);
uri += "&body=";
uri += encodeURIComponent(body);
window.location.href = uri;
}
</script>

<li><a href="javascript:(function()%7BSendLinkByMail()%3B%7D)()%3B" target="_blank"><i class="fa fa-envelope-o"></i> Feedback</a></li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/algorithms/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: '/algorithms/search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Hidden Markov Models">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>
<!-- Page Content -->
<div class="container">
    <div class="col-lg-12">&nbsp;</div>
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">

          












<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Algorithms 1.0</li>
    
    
    
        
    
    <li>
        <a href="#">General</a>
        <ul>
            
            
            
            <li><a href="/algorithms/arrays/">Arrays</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Machine Learning</a>
        <ul>
            
            
            
            <li class="active"><a href="/algorithms/hmm/">Hidden Markov Models</a></li>
            
            
            
            
            
            
            <li><a href="/algorithms/markovchains/">Markov Chains</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Metrics</a>
        <ul>
            
            
            
            <li><a href="/algorithms/ncd/">Normalized Compression Distance</a></li>
            
            
            
            
        </ul>
        
        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>
</div>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>
    <!-- Content Column -->
    <div class="col-md-9">
        <div class="post-header">
   <h1 class="post-title-main">Hidden Markov Models</h1>
</div>

<div class="post-content">

   
    <div class="summary">Hidden Markov Models</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

    

    

    <a target="_blank" href="https://github.com/stefan-j/stefan-j.github.io/hmm/" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

    

  <h2 id="introduction">Introduction</h2>

<p><img src="../images/hmm1.png" alt="" /></p>

<p>HMM are stochastic methods that are used to model sequential data such as speech and gesture recognition. Both the underlying process which is hidden is stochastic and the observable process. Only a first order HMM will be considered.</p>

<p>Under the Markov property, the next state is only dependent on the current state of the system. Such states may not be known and may be hidden from the observer as only the output values are observable. When an event is generated from a state, the model moves into a new state based on its transition probabilities. The term hidden is commonly used to indicate that many different state sequences can generate the same observed sequence of events.</p>

<p>The HMM is formally defined by the triple:
\[\lambda = (A,B,\pi) \]</p>

<p>where A is the transition matrix, B the emission matrix and \( \pi \) the initial state vector. Let \(S\) be the set of states, \(V\) the set of observations, \(Q\) a fixed state sequence of length \(T\) and \(O\) a corresponding observation sequence.
The transition probabilities are then given by:</p>

<script type="math/tex; mode=display">A = P(q_t = s_j | q_{t-1} = s_i)</script>

<p>and the emission probabilities are given by:</p>

<script type="math/tex; mode=display">B = P(o_t = v_k | q_t = s_i)</script>

<p>and the initial state probabilities by:</p>

<p>\[ \pi = P(q_1 = s_i) \]</p>

<p>Given a sequence of observations, we want to compute the probability of an observation sequence given the model.</p>

<p>The probability of the observation sequence \( O \) for a state sequence is given by:
\[ P(O|Q,\lambda) = \prod^T_{t=1} P(o_t | q_t,\lambda) \]
The probability of the state sequence is simply a product of the state path:
\[ P(Q|\lambda)= \pi_{q_1}a_{q_1 q_2} \cdots a_{q_{T-1} q_T} \]
Thus the probability of the observations given the model can be calculated by:
\[ P(O|\lambda) = \sum_Q P(O|Q,\lambda) P(Q|\lambda) \]</p>

<p>The forward algorithm calculates this efficiently by caching previous calculations.</p>

<h2 id="training">Training</h2>

<p>A variety of learning algorithms exist which compute the structure of the model and also calculate the emission and transmission matrices. The Baum-Welch is an unsupervised learning algorithm which re-estimates the parameters \( (A,B,\pi) \). The training problem can be solved in terms of joint events and state variables.</p>

<p>The joint variable \( \xi_t(i,j) = P(q_t = S_i, q_{t+1} = S_j|S, \lambda) \) is given by:
\[ \frac{\alpha_t (j) a_{ij} b_j (O_{t+1}) \beta_{t+1}(j) }{\sum_{k=1}^N \sum_{l=1}^N \alpha_t (k) a_{kl} b_l (O_{t+1}) \beta_{t+1}(l) } \]</p>

<p>The state variable \( \gamma_t(i) = P(q_t = S_i | O, \lambda) \) is given by:
\[ 
\gamma_t(i) = \frac{\alpha_t (i) \beta_t(i)}{\sum_{j=1}^N \alpha_t (j) \beta_t (j)}
\]</p>

<p>Upon which the parameters can be updated (by the Baum-Welch method).</p>

<p>The updated state transition probability is then given by: 
\[
a^u_{ij} = \frac{\sum_{t=1}^{T-1} \xi_t (i,j)}{\sum_{t=1}^{T-1} \gamma_t (i)} 
\]</p>

<p>The updated emission probability is given by:
\[ b^u_j (k) = \frac{\sum^T_{t=1,o_t = v_k} \gamma_t (j)}{\sum^T_{t=1} \gamma_t (j)} \]</p>

<p>The updated initial probability by:
\[ \pi^u_i = \gamma_1 (i) \]</p>

<p>Where the superscript u denotes the updated parameter.</p>

<p>However this only covers the case where the model is updated upon a single observation. How do we update the model to match multiple observations?.
Xiaolin Li has a combinatorial method to update the HMM with multiple observations: Training Hidden Markov Models with Multiple Observations - A Combinatorial Method, in which he and his colleagues describe a general method.</p>

<p>We will cover only a specific case.</p>

<p>In order to operate on multiple observations the independence assumption was made, that is (such an assumption does not have to be made, but this will simplify things):
\[ P(O | \lambda) = \prod_{k=1}^K P(O^{(k)} | \lambda) \]
For which the update rules according to Levinson are:</p>

<ul>
  <li>
    <p>State transition:
\[ a^u_{mn} = \frac{\sum_{k=1}^K \sum_{t=1}^{T_k -1 }  \xi_t^{(k)} (m,n)}{\sum_{k=1}^K \sum_{t=1}^{T_k-1} \gamma_t^{(k)}(m)} \]</p>
  </li>
  <li>
    <p>Observation emission:
\[ b^u_n (m) = \frac{\sum_{k=1}^K \sum_{t=1, o_t^{(k)} = v_m}^{T_k -1 } \gamma_t^{(k)} (n)}{\sum_{k=1}^K \sum_{t=1}^{T_k-1} \gamma_t^{(k)}(n)} \]</p>
  </li>
  <li>
    <p>Initial state:
\[ \pi^u_n = \frac{1}{K} \sum_{k=1}^K \gamma_1^{(k)}(n)  \]</p>
  </li>
</ul>

<h2 id="composition">Composition</h2>
<p>HMMs have been applied with some degree of success to music composition. A system has been developed for producing a counterpoint line to a cantus firmis in the style of Palestrina Farbood2001. Another approach utilizes a HMM for chorale melody harmonization Allan2004.</p>


<div class="tags">
    
    <b>Tags: </b>
    
    
    
    
    
    
    
    
    
</div>

    

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2016 Stefan Jacholke. All rights reserved. <br />
<p>Page last updated:</span> March 20, 2016<br/> Site last generated: May 23, 2016 <br />
<p><img src="/algorithms/images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>
    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
    </div>
    <script>
    jQuery(function ($) {
        $('.post-content').annotator()
                .annotator('setupPlugins', {tokenUrl: 'http://example.com/api/token'})
    });
    </script>
</body>

</html>
